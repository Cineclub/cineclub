<h1><%= @team.name %></h1>
<p><small class="text-muted">Created <%= time_ago_in_words(@team.created_at) %> ago.</small></p>

<div class="card">
  <div class="card-header">Members</div>
  <% if @team.users.present? %>
    <ul class="list-group list-group-flush">
      <% @team.users.each do |user| %>
        <li class="list-group-item"><%= user.full_name %></li>
      <% end %>
    </ul>
  <% else %>
    <div class="card-body">
      <p>No members have joined this team yet.</p>
    </div>
  <% end %>
</div>

<% if signed_in? %>
  <p class="mt-3">
    <% if current_user.member_of?(@team) %>
      <%= link_to 'Leave', leave_team_path(@team), method: :patch, class: "btn btn-secondary" %>
    <% else %>
      <%= link_to 'Join', join_team_path(@team), method: :patch, class: "btn btn-primary" %>
    <% end %>
  </p>
<% end %>

<div class="mt-4">
  <h2>Game rounds</h2>
  <% if @team.rounds.present? %>
    <div class="row mt-3">
      <% @team.rounds.each do |round| %>
        <div class="col-md-3 mb-4">
          <div class="card h-100">
            <div class="card-body">
              <% if round.movie.present? %>
                <h5 class="card-title"><%= round.movie.original_title %></h5>
                <h6 class="card-subtitle mb-2 text-muted"><%= round.movie.directors.map(&:name).join(', ') %></h6>
              <% else %>
                <h5 class="card-title">No movie set</h5>
                <h6 class="card-subtitle mb-2 text-muted">â€”</h6>
              <% end %>
              <p class="card-text"><%= round.user.first_name %>'s turn</p>
            </div>
            <div class="card-footer">
              <%= link_to 'Round details', round_path(round), class: "card-link" %>
              <% if policy(round).edit? %>
                <%= link_to 'Set movie', edit_round_path(round), class: "card-link" %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p>No rounds have been created yet.</p>
  <% end %>

  <% if policy(@team).create_round? %>
    <p><%= link_to 'Create New Round', team_rounds_path(@team), method: :post, class: "btn btn-primary" %></p>
  <% end %>
</div>
